<!-- POS Screen (Cloudflare + Neon) -->
<div class="page">

  <!-- Standard screen chrome -->
  <div id="screen-banner" class="mb-3 hidden"></div>
  <div id="screen-access-denied" class="hidden">
    <div class="card p-3">Access denied</div>
  </div>
  <div id="screen-loading" class="card p-3">
    Loading POSâ€¦
  </div>

  <div id="screen-content" class="hidden">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">

    <!-- LEFT: Search / Results -->
    <div class="card p-3">
      <div class="flex items-center justify-between mb-2">
        <div class="font-semibold">Inventory Search</div>
      </div>
      <div class="flex items-center gap-2 mb-2">
        <input id="pos-search" class="input w-full" placeholder="+ Misc â€” or â€” type to search" />
        <button id="pos-search-btn" class="btn btn-primary">Search</button>
        <button id="pos-search-clear" class="btn btn-ghost">Clear</button>
      </div>

        <div id="pos-quick-row" class="flex items-center gap-2 mb-3">
          <button id="pos-quick-misc" class="btn btn-sm">+ Misc</button>
          <span class="text-sm text-muted">â€” or â€”</span>
          <span class="text-xs text-muted">Use the search box to find inventory</span>
        </div>

        <div id="pos-results" class="space-y-2 max-h-[60vh] overflow-auto">
          <!-- search results with â€œAddâ€ buttons go here -->
        </div>
      </div>

      <!-- RIGHT: Ticket -->
      <div class="card p-3">
        <div class="flex items-center justify-between mb-2">
          <div class="font-semibold">Ticket</div>
          <div class="flex items-center gap-2">
            <button id="pos-ticket-empty" class="btn btn-ghost btn-sm">Empty</button>
          </div>
        </div>

                <!-- Full-width Ticket column: Cart â†’ Totals â†’ Payment row -->
        <div>
          <!-- CART (full width) -->
          <div id="pos-cart" class="grid grid-cols-1 gap-2">
            <!-- rows injected -->
          </div>

          <!-- TOTALS (share exact padding with item rows) -->
          <div class="mt-3 ticket-row ticket-row--totals">
            <!-- Match the item-row control bar layout -->
            <div class="ticket-controls flex items-center justify-between gap-2 flex-wrap">
              <!-- Left cluster (QTY spacer) â€” intentionally empty to keep columns consistent -->
              <div class="inline-flex items-center gap-1"></div>
          
              <!-- Right cluster (amount + action column) -->
              <div class="flex items-center gap-2 flex-1 justify-end flex-wrap">
                <div class="pos-totals text-right w-[320px] max-w-full">
                  <div class="flex justify-between py-1">
                    <span class="text-muted">Subtotal</span>
                    <span id="pos-subtotal">$0.00</span>
                  </div>
                  <div class="flex justify-between py-1">
                    <span class="text-muted">Discounts</span>
                    <span id="pos-discounts">$0.00</span>
                  </div>
                  <div class="flex justify-between py-1">
                    <span class="text-muted">Tax</span>
                    <span id="pos-tax">$0.00</span>
                  </div>
                  <div class="flex justify-between py-2 border-t mt-2 font-semibold">
                    <span>Total</span>
                    <span id="pos-total">$0.00</span>
                  </div>
                </div>
                <!-- Invisible placeholder = same width/shape as the real Remove button.
                     Keeps the outer edge identical to item rows. -->
                <button class="btn btn-ghost btn-xs btn-placeholder" aria-hidden="true" tabindex="-1">Remove</button>
              </div>
            </div>
          </div>
          
          <!-- PAYMENT ROW (single horizontal row; wraps nicely on small screens) -->
          <div class="mt-2 pos-pay-row">
            <select id="pos-payment" class="select pos-pay-item">
              <option value="" selected disabled>Select paymentâ€¦</option>
              <option value="cash">CASH</option>
              <option value="card:visa">Visa (Valor)</option>
              <option value="card:mastercard">MasterCard (Valor)</option>
              <option value="card:amex">Amex (Valor)</option>
              <option value="card:discover">Discover (Valor)</option>
              <option value="wallet:venmo">Venmo</option>
              <option value="wallet:zelle">Zelle</option>
              <option value="wallet:cashapp">Cash App</option>
            </select>

            <button id="pos-split" class="btn btn-ghost pos-pay-item">Split payment</button>
            <button id="pos-complete" class="btn btn-primary pos-pay-item pos-pay-push" disabled>Complete Sale</button>
          </div>

          <!-- CASH PAYMENT MODAL -->
          <div id="pos-cash-modal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="pos-cash-title">
            <div class="modal-card card">
              <div class="flex items-center justify-between mb-2">
                <div id="pos-cash-title" class="font-semibold">Cash Payment</div>
                <button id="pos-cash-close" class="btn btn-ghost btn-sm" aria-label="Close">Close</button>
              </div>

              <div class="stack-16">
                <div>
                  <label>Total Due</label>
                  <input id="pos-cash-total" type="number" class="input" readonly />
                </div>
                <div>
                  <label>Amount Received</label>
                  <input id="pos-cash-received" type="number" class="input" inputmode="decimal" placeholder="Enter amount received" />
                </div>
                <div>
                  <label>Change Due</label>
                  <input id="pos-cash-change" type="number" class="input" readonly />
                </div>

                <div class="flex items-center gap-2">
                  <button id="pos-cash-exact" class="btn btn-ghost">Exact amount</button>
                  <button id="pos-cash-round" class="btn btn-ghost">Round to next $</button>
                  <button id="pos-cash-confirm" class="btn btn-primary pos-pay-push">Confirm Cash</button>
                </div>
              </div>
            </div>
          </div>

          <!-- SPLIT PAYMENT MODAL -->
          <div id="pos-split-modal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="pos-split-title">
            <div class="modal-card card">
              <div class="flex items-center justify-between mb-2">
                <div id="pos-split-title" class="font-semibold">Split Payment</div>
                <button id="pos-split-close" class="btn btn-ghost btn-sm" aria-label="Close">Close</button>
              </div>

              <div class="stack-16">
                <div class="muted text-sm">Distribute the total across multiple payments.</div>

                <div class="overflow-auto">
                  <table class="table w-full" id="pos-split-table">
                    <thead>
                      <tr>
                        <th class="text-left">Method</th>
                        <th class="text-left">Amount</th>
                        <th class="text-left">Actions</th>
                      </tr>
                    </thead>
                    <tbody id="pos-split-body">
                      <!-- rows injected -->
                    </tbody>
                  </table>
                </div>

                <div class="flex items-center gap-2">
                  <select id="pos-split-method" class="select">
                    <option value="cash">CASH</option>
                    <option value="card:visa">Visa (Valor)</option>
                    <option value="card:mastercard">MasterCard (Valor)</option>
                    <option value="card:amex">Amex (Valor)</option>
                    <option value="card:discover">Discover (Valor)</option>
                    <option value="wallet:venmo">Venmo</option>
                    <option value="wallet:zelle">Zelle</option>
                    <option value="wallet:cashapp">Cash App</option>
                  </select>
                  <input id="pos-split-amount" type="number" class="input" inputmode="decimal" placeholder="Amount" />
                  <button id="pos-split-add" class="btn btn-ghost">Add Payment</button>
                </div>

                <div class="flex items-center justify-between">
                  <div class="muted">Remaining:</div>
                  <div id="pos-split-remaining" class="font-semibold">$0.00</div>
                </div>

                <div class="flex items-center">
                  <button id="pos-split-confirm" class="btn btn-primary pos-pay-push" disabled>Confirm Split</button>
                </div>
              </div>
            </div>
          </div>

            
            
        </div>


        <!-- Optional: debug/save logs toggle (kept full width under the grid) -->
        <details class="mt-3">
          <summary class="text-sm">View save logs</summary>
          <pre id="pos-logs" class="text-xs p-2 bg-muted/20 rounded"></pre>
        </details>
      </div>

    </div> <!-- ðŸ‘ˆ CLOSE the outer two-column wrapper -->

    <!-- BELOW: Sales list (today/custom) -->
    <div class="card p-3 mt-3">
      <div class="flex items-center justify-between mb-2">
        <div class="font-semibold">Sales (Today / Custom)</div>
        <div class="flex items-center gap-2">
          <button id="pos-sales-today" class="btn btn-sm">Today</button>
          <span class="text-sm">or</span>
          <input id="pos-date-from" type="date" class="input input-sm" />
          <span class="text-sm">to</span>
          <input id="pos-date-to" type="date" class="input input-sm" />
          <button id="pos-sales-load" class="btn btn-sm btn-primary">Load</button>
        </div>
      </div>
      <div class="overflow-auto">
        <table class="table w-full">
          <thead>
            <tr>
              <th class="text-left">Time</th>
              <th class="text-left">Sale ID</th>
              <th class="text-left">Payment</th>
              <th class="text-left">Total</th>
              <th class="text-left">Clerk</th>
              <th class="text-left">Actions</th>
            </tr>
          </thead>
          <tbody id="pos-sales-body">
            <!-- rows -->
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
